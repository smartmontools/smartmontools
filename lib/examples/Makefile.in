#
# Makefile for libsmartmon examples
#
# Home page of code is: https://www.smartmontools.org
#
# Copyright (C) 2025 Christian Franke
#
# SPDX-License-Identifier: GPL-2.0-or-later
#

V = 1
CPPFLAGS = @examples_cppflags@
CXXFLAGS = @examples_cxxflags@
LDFLAGS = @examples_ldflags@

# Platform specific defines
LIBS = @examples_libs@
EXEEXT = @EXEEXT@

## Darwin
#LIBS = -framework CoreFoundation -framework IOKit
## FreeBSD
#LIBS = -lcam -lsbuf # -lusb
## NetBSD, OpenBSD
#LIBS = -lutil
## Windows
#LIBS = -lole32 -loleaut32 # -ladvapi -lwinpthread
#EXEEXT = .exe
## Cygwin
#LIBS = -lole32 -loleaut32
#EXEEXT = .exe

LDLIBS = -lsmartmon $(LIBS)

PROGRAMS = ata-standby$(EXEEXT) lsdisk$(EXEEXT)

all: $(PROGRAMS)

v_CXX = $(v_CXX_$(V))
v_CXX_ = $(v_CXX_1)
v_CXX_0 = @echo "  CXX     " $@;
v_CXX_1 =

.SUFFIXES:
.SUFFIXES: .cpp $(EXEEXT)

.cpp$(EXEEXT):
	$(v_CXX)$(CXX) $(CPPFLAGS) $(CXXFLAGS) $(LDFLAGS) -o $@ $< $(LDLIBS)

SBINDIR = /usr/local/sbin
INSTALL = cp

install: all
	mkdir -p $(DESTDIR)$(SBINDIR)
	@for f in $(PROGRAMS); do \
	  echo "$(INSTALL) $$f $(DESTDIR)$(SBINDIR)"; \
	  $(INSTALL) $$f $(DESTDIR)$(SBINDIR); \
	done

uninstall:
	@for f in $(PROGRAMS); do \
	  test -f $(DESTDIR)$(SBINDIR)/$$f || continue; \
	  echo "rm -f $(DESTDIR)$(SBINDIR)/$$f"; \
	  rm -f $(DESTDIR)$(SBINDIR)/$$f; \
	done

clean:
	rm -f $(PROGRAMS)
